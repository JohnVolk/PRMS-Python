
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>API Reference &#8212; PRMS-Python v1.0.0</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/prms-python-32x.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Tutorial and Recipes" href="tutorial.html" /> 
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono|Pacifico|Open+Sans|Metrophobic' rel='stylesheet' type='text/css'>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="prms_python.ScenarioSeries">
<em class="property">class </em><code class="descclassname">prms_python.</code><code class="descname">ScenarioSeries</code><span class="sig-paren">(</span><em>base_dir</em>, <em>scenarios_dir</em>, <em>title=None</em>, <em>description=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/scenario.html#ScenarioSeries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.ScenarioSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for a series of related scenario model runs. The user can
initialize the series with a title and a description. Then to build
the series the user provides a list of dictionaries with parameter-function
key-value pairs, and optionally a title and description for each dictionary
defining the individual scenario.</p>
<p>The ScenarioSeries’ <code class="docutils literal notranslate"><span class="pre">build</span></code> method creates a directory structure under
the series directory (<code class="docutils literal notranslate"><span class="pre">{series-directory}</span></code>) where each
subdirectory is named with a UUID which can be matched to its title using
the metadata in <code class="docutils literal notranslate"><span class="pre">{series-directory}/series_metadata.json</span></code>.</p>
<p>In the future we may add a way for the user to access the results of
the scenario simulations directly through the series, but for now the
results are written to disk and the user must load them manually. It’s
maybe a little clunky, but here we use the title metadata to be able to
reference the statsvar file for a particular set of scale factors. See
below how to build the statvar path after running a series of scenarios.
See the online documentation for a full example.</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_ser</span> <span class="o">=</span> <span class="n">ScenarioSeries</span><span class="p">(</span>
<span class="go">        &#39;base_inputs&#39;, &#39;scenario_dir&#39;, title=&#39;my title&#39;,</span>
<span class="go">        description=&#39;series description&#39;</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">_scale_fun</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="go">        def scale(x):</span>
<span class="go">            return x*val</span>
<span class="go">        return scale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_list</span> <span class="o">=</span> <span class="p">[</span>
<span class="go">        {</span>
<span class="go">            &#39;rad_trncf&#39;: _scale_fun(val),</span>
<span class="go">            &#39;snow_adj&#39;: _scale_fun(val),</span>
<span class="go">            &#39;title&#39;:</span>
<span class="go">                &#39;&quot;rad_trncf&quot;:{0:%.1f}|&quot;snow_adj&quot;:{0:%.1f}&#39;.format(val)</span>
<span class="go">        } for val in np.arange(0.7, 0.9, 0.1)</span>
<span class="go">    ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_ser</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">sc_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc_ser</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">series_md</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
<span class="go">        open(os.path.join(&#39;scenario_dir&#39;, &#39;series_metadata.json&#39;)).read()</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uuid_title_map</span> <span class="o">=</span> <span class="n">series_md</span><span class="p">[</span><span class="s1">&#39;uuid_title_map&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uu</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">uuid_title_map</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()</span>
<span class="go">            if v == &#39;&quot;rad_trncf&quot;:0.7|&quot;snow_adj&quot;:0.7&#39;][0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">statvar_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<span class="go">        &#39;scenario_dir&#39;, uu, &#39;outputs&#39;, &#39;statvar.dat&#39;</span>
<span class="go">    )</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="prms_python.ScenarioSeries.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>scenarios_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/scenario.html#ScenarioSeries.build"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.ScenarioSeries.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the scenarios from a list of scenario definitions in dicitonary
form. Each element of scenarios_list can have any number of parameters
as keys with a function for each value. The other two acceptable keys
are title and description which will be passed on to each individual
Scenario’s metadata for future lookups.</p>
<p>See the example in ScenarioSeries docstring above for a usage example.</p>
<p>Calling <code class="docutils literal notranslate"><span class="pre">build</span></code> will create the directory structure explained in
the class docstring.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><dl class="first last docutils">
<dt>scenarios_list (list): list of dictionaries with key-value</dt>
<dd>pairs being parameter-function definition pairs or
title-title string or description-description string.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>None</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="prms_python.ScenarioSeries.from_parameters_iter">
<em class="property">classmethod </em><code class="descname">from_parameters_iter</code><span class="sig-paren">(</span><em>base_directory</em>, <em>parameters_iter</em>, <em>title=None</em>, <em>description=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/scenario.html#ScenarioSeries.from_parameters_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.ScenarioSeries.from_parameters_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ScenarioSeries from a list of parameters and the path to a
directory in which scenarios should be saved and a data and control
file can be found.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="prms_python.Scenario">
<em class="property">class </em><code class="descclassname">prms_python.</code><code class="descname">Scenario</code><span class="sig-paren">(</span><em>base_dir</em>, <em>scenario_dir</em>, <em>title=None</em>, <em>description=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/scenario.html#Scenario"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.Scenario" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for the process in which one modifies some base files then
runs a simulation on the modified files. This also tracks metadata,
including a title and description, if provided, plus start/end datetime
and strings of the modification functions python code.</p>
</dd></dl>

<span class="target" id="parameters"></span><dl class="class">
<dt id="prms_python.Parameters">
<em class="property">class </em><code class="descclassname">prms_python.</code><code class="descname">Parameters</code><span class="sig-paren">(</span><em>base_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/parameters.html#Parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.Parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Disk-based representation of a PRMS parameter file. For the sake of
memory efficiency, we only load parameters from <code class="docutils literal notranslate"><span class="pre">base_file</span></code> that get
modifified through item assignment, for example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">(</span><span class="s1">&#39;example_params&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;jh_coef&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;jh_coef&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;example_modified_params&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>will read parameter information from the params file to check that
<code class="docutils literal notranslate"><span class="pre">jh_coef</span></code> is present in the parameter file, read the lines corresponding
to <code class="docutils literal notranslate"><span class="pre">jh_coef</span></code> data and assign the new value as requested. Internally,
a reference is kept to only modified parameter data,
so when <code class="docutils literal notranslate"><span class="pre">p.write(modified_params_file)</span></code> is called, mostly this will copy
from <code class="docutils literal notranslate"><span class="pre">base_file</span></code> to <code class="docutils literal notranslate"><span class="pre">modified_params_file</span></code>.</p>
<dl class="method">
<dt id="prms_python.Parameters.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>nrows</em>, <em>which='all'</em>, <em>out_dir=None</em>, <em>xlabel=None</em>, <em>ylabel=None</em>, <em>cbar_label=None</em>, <em>title=None</em>, <em>mpl_style=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/parameters.html#Parameters.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.Parameters.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot PRMS parameters as time series or 2D spatial grid depending on 
parameter dimension. The PRMS parameter file is assumed to represent 
a model that was set up on a uniform rectangular grid with the spatial 
index of HRUs starting in the upper left corner and moving left to 
right across columns and down rows.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><dl class="first last docutils">
<dt>params (prms_python.Parameters): An instance of Parameters that </dt>
<dd>corresponds with the PRMS parameter file to plot.</dd>
<dt>nrows (int): The number of rows in the PRMS model grid for plotting </dt>
<dd>spatial parameters. Function will only work for rectangular 
gridded models with HRU indices starting in the upper left cell 
moving left to right across columns and down across rows.</dd>
</dl>
</dd>
<dt>Kwargs:</dt>
<dd><dl class="first docutils">
<dt>which (str): name of PRMS parameter to plot or ‘all’. If ‘all’ then</dt>
<dd>the function will print 3 multipage pdfs, one for nhru 
dimensional parameters, one for nhru by monthly parameters, one 
for other parameters of length &gt; 1, and one html file containing
single valued parameters</dd>
</dl>
<p>out_dir (str): path to an output dir, default current directory
xlabel (str): x label for plot(s)
ylabel (str): y label for plot(s)
cbar_label (str): label for colorbar on spatial plot(s)
title (str): plot title
mpl_style (str, list): name or list of names of matplotlib style</p>
<blockquote class="last">
<div>sheets to use for plot(s)</div></blockquote>
</dd>
<dt>Returns: </dt>
<dd>None</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="data"></span><dl class="class">
<dt id="prms_python.Data">
<em class="property">class </em><code class="descclassname">prms_python.</code><code class="descname">Data</code><span class="sig-paren">(</span><em>base_file=None</em>, <em>na_rep=-999</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/data.html#Data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.Data" title="Permalink to this definition">¶</a></dt>
<dd><p>Object to access or create a PRMS data file with ability to load/assign it to a 
date-time indexed pandas.DataFrame for data management, analysis and visualization. 
It can be used to build a new PRMS data file from user defined metadata and  
pandas.DataFrame. The <code class="docutils literal notranslate"><span class="pre">modify</span></code> method allows for inplace modification of 
one or more time series inputs in the data file based on a user defined function. 
The <code class="docutils literal notranslate"><span class="pre">write</span></code> method reformats the Dataframe to PRMS text format and writes 
a new data file to disk. If the initial data was not accessed the write method 
simply makes a copy of the original file, to save memory and improve computational
efficiency. Here is an example of loading a data file, modifying the temperature 
inputs (‘tmin’ and ‘tmax’) by adding two degrees to each element, and rewritting 
the modified data to disk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="s1">&#39;path_to_data_file&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="go">        return x + 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">f</span><span class="p">,[</span><span class="s1">&#39;tmax&#39;</span><span class="p">,</span><span class="s1">&#39;tmin&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;example_modified_data_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>d is a Data instance of example_data_file, calling</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">data_frame</span> 
</pre></div>
</div>
<p>shows the datetime indexed pd.DataFrame of the input data that is created 
when a <code class="docutils literal notranslate"><span class="pre">Data</span></code> object is initiated. We then pass the function f(x) to d.modify 
along with a Python list of input variable/s that we want to modify, this 
modifies d.data_frame in place. Printing the metadata attribute of the data
object,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">metadata</span>
</pre></div>
</div>
<p>will show the names of the variables in the data file in case you forget which
you would like to modify. Last we call d.write with an output path to write 
the modified data variables to disk in PRMS text format.</p>
</dd></dl>

<span class="target" id="optimizer"></span><dl class="class">
<dt id="prms_python.Optimizer">
<em class="property">class </em><code class="descclassname">prms_python.</code><code class="descname">Optimizer</code><span class="sig-paren">(</span><em>parameters</em>, <em>data</em>, <em>control_file</em>, <em>working_dir</em>, <em>title</em>, <em>description=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/optimizer.html#Optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.Optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for PRMS parameter optimization routines that are 
defined as stages similar to what is described in Hay, et al, 2006
(<a class="reference external" href="ftp://brrftp.cr.usgs.gov/pub/mows/software/luca_s/jawraHay.pdf">ftp://brrftp.cr.usgs.gov/pub/mows/software/luca_s/jawraHay.pdf</a>).
Currently the <code class="docutils literal notranslate"><span class="pre">monte_carlo</span></code> method provides random parameter 
resampling routines using uniform and normal random variables.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">prms_python</span> <span class="k">import</span> <span class="n">Data</span><span class="p">,</span> <span class="n">Optimizer</span><span class="p">,</span> <span class="n">Parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">(</span><span class="s1">&#39;path/to/parameters&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="s1">&#39;path/to/data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">control</span> <span class="o">=</span> <span class="s1">&#39;path/to/control&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">work_directory</span> <span class="o">=</span> <span class="s1">&#39;path/to/create/simulations&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optr</span> <span class="o">=</span> <span class="n">Optimizer</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">work_directory</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;the title&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;desc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">measured</span> <span class="o">=</span> <span class="s1">&#39;path/to/measured/csv&#39;</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">statvar_name</span> <span class="o">=</span> <span class="s1">&#39;basin_cfs&#39;</span> <span class="c1"># or any other valid statvar </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params_to_resample</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dday_intcp&#39;</span><span class="p">,</span> <span class="s1">&#39;dday_slope&#39;</span><span class="p">]</span> <span class="c1"># list of params</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optr</span><span class="o">.</span><span class="n">monte_carlo</span><span class="p">(</span><span class="n">measured</span><span class="p">,</span> <span class="n">params_to_resample</span><span class="p">,</span> <span class="n">statvar_name</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="optimizationresult"></span><dl class="class">
<dt id="prms_python.OptimizationResult">
<em class="property">class </em><code class="descclassname">prms_python.</code><code class="descname">OptimizationResult</code><span class="sig-paren">(</span><em>working_dir</em>, <em>stage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/optimizer.html#OptimizationResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.OptimizationResult" title="Permalink to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">OptimizationResult</span></code> object serves to collect and manage output 
from an <code class="docutils literal notranslate"><span class="pre">Optimizer</span></code> method. Upon initialization and a given optimization
stage that was used when running the Optimizer method, e.g. <code class="docutils literal notranslate"><span class="pre">monte_carlo</span></code>,
the class gathers all JSON metadata that was produced for the given stage. 
The <code class="docutils literal notranslate"><span class="pre">OptimizationResult</span></code> has three main user methods: first <code class="docutils literal notranslate"><span class="pre">result_table</span></code> 
which returns the top n simulations according to four model performance 
metrics (Nash-Sutcliffe efficiency (NSE), root-mean squared-error (RMSE), 
percent bias (PBIAS), and the coefficient of determination (COEF_DET) as
calculated against measured data. For example the table may look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ddsolrad_res</span> <span class="o">=</span> <span class="n">OptimizationResult</span><span class="p">(</span><span class="n">work_directory</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="n">stage</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top10</span> <span class="o">=</span> <span class="n">ddsolrad_res</span><span class="o">.</span><span class="n">result_table</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span><span class="n">top_n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top10</span>
<span class="go">    ========================  ========  =======  =========   ========</span>
<span class="go">    ddsolrad parameters       NSE       RMSE     PBIAS       COEF_DET</span>
<span class="go">    ========================  ========  =======  =========   ======== </span>
<span class="go">    orig_params               0.956267  39.4725  -0.885715   0.963116</span>
<span class="go">    tmax_index_54.2224631748  0.921626  47.6092  -0.849256   0.94402</span>
<span class="go">    tmax_index_44.8823940703  0.879965  58.9194  5.79603     0.922021</span>
<span class="go">    tmax_index_47.6835387480  0.764133  82.5918  -4.78896    0.837582</span>
<span class="go">    ========================  ========  =======  =========   ========</span>
</pre></div>
</div>
<p>Second, the <code class="docutils literal notranslate"><span class="pre">get_top_ranked_sims</span></code> which returns a dictionary that map 
key information about the top n ranked simulations, an example returned 
dictionary may look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">{</span>
<span class="go">      &#39;dir_name&#39; : [&#39;pathToSim1&#39;, &#39;pathToSim2&#39;],</span>
<span class="go">      &#39;param_path&#39; : [&#39;pathToSim1/input/parameters&#39;, &#39;pathToSim2/input/parameters&#39;],</span>
<span class="go">      &#39;statvar_path&#39; : [&#39;pathToSim1/output/statvar.dat&#39;, &#39;pathToSim2/output/statvar.dat&#39;],</span>
<span class="go">      &#39;params_adjusted&#39; : [[param_names_sim1], [param_names_sim2]]</span>
<span class="go">    }</span>
</pre></div>
</div>
<p>The third method of <code class="docutils literal notranslate"><span class="pre">OptimizationResult</span></code> is <code class="docutils literal notranslate"><span class="pre">archive</span></code> which essentially 
opens all parameter and statvar files from each simulation of the given 
stage and archives the parameters that were modified and their modified values
and the statistical variable (PRMS time series output) that is associated with 
the optimization stage.  Other <code class="docutils literal notranslate"><span class="pre">Optimizer</span></code> simulation metadata is also gathered
and new JSON metadata containing only this information is created and written
within a newly created “archived” subdirectory within the same directory that 
the <code class="docutils literal notranslate"><span class="pre">Optimizer</span></code> routine managed simulations. The <code class="docutils literal notranslate"><span class="pre">OptimizationResult.archive</span></code>
method then recursively deletes the simulation data for each of the given stage.</p>
</dd></dl>

</div>
<div class="section" id="data-parameter-statsvar-helper-functions">
<h2>Data, Parameter, Statsvar helper functions<a class="headerlink" href="#data-parameter-statsvar-helper-functions" title="Permalink to this headline">¶</a></h2>
<span class="target" id="load-data"></span><dl class="function">
<dt id="prms_python.load_data_file">
<code class="descclassname">prms_python.</code><code class="descname">load_data_file</code><span class="sig-paren">(</span><em>data_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/util.html#load_data_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.load_data_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the data file and load into a datetime indexed Pandas dataframe object.</p>
<dl class="docutils">
<dt>Arguments: </dt>
<dd>data_file (str): data file path</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>df (pandas.DataFrame): Pandas dataframe of input time series data </dt>
<dd>from data file with datetime index</dd>
</dl>
</dd>
</dl>
</dd></dl>

<span class="target" id="load-statvar"></span><dl class="function">
<dt id="prms_python.load_statvar">
<code class="descclassname">prms_python.</code><code class="descname">load_statvar</code><span class="sig-paren">(</span><em>statvar_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/util.html#load_statvar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.load_statvar" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the statvar file and load into a datetime indexed
Pandas dataframe object</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd>statvar_file (str): statvar file path</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>(pandas.DataFrame) Pandas DataFrame of PRMS variables date indexed</dt>
<dd>from statvar file</dd>
</dl>
</dd>
</dl>
</dd></dl>

<span class="target" id="modify-params"></span><dl class="function">
<dt id="prms_python.modify_params">
<code class="descclassname">prms_python.</code><code class="descname">modify_params</code><span class="sig-paren">(</span><em>params_in</em>, <em>params_out</em>, <em>param_mods=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/parameters.html#modify_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.modify_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a parameter file in and a dictionary of param_mods, write modified
parameters to params_out.</p>
<p>Example:</p>
<p>Below we modify the monthly jh_coef by increasing it 10% for every month.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params_in</span> <span class="o">=</span> <span class="s1">&#39;models/lbdc/params&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params_out</span> <span class="o">=</span> <span class="s1">&#39;scenarios/jh_coef_1.1/params&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_10pct</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">1.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">modify_params</span><span class="p">(</span><span class="n">params_in</span><span class="p">,</span> <span class="n">params_out</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;jh_coef&#39;</span><span class="p">:</span> <span class="n">scale_10pct</span><span class="p">})</span>
</pre></div>
</div>
<p>So param_mods is a dictionary of with keys being parameter names and
values a function that operates on a single value. Currently we only
accept functions that operate without reference to any other parameters. 
The function will be applied to every cell, month, or cascade routing rule 
for which the parameter is defined.</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><p class="first">params_in (str): location on disk of the base parameter file</p>
<dl class="docutils">
<dt>params_out (str): location on disk where the modified parameters will </dt>
<dd>be written</dd>
</dl>
<p class="last">param_mods (dict): param name-keyed, param modification function-valued</p>
</dd>
<dt>Returns:</dt>
<dd>None</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="nash-sutcliffe">
<h2>Nash-Sutcliffe<a class="headerlink" href="#nash-sutcliffe" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="prms_python.nash_sutcliffe">
<code class="descclassname">prms_python.</code><code class="descname">nash_sutcliffe</code><span class="sig-paren">(</span><em>observed</em>, <em>modeled</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/prms_python/util.html#nash_sutcliffe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#prms_python.nash_sutcliffe" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Nash-Sutcliffe Goodness-of-fit</p>
<dl class="docutils">
<dt>Arguments:</dt>
<dd><p class="first">observed (numpy.ndarray): historic observational data</p>
<p class="last">modeled (numpy.ndarray): model output with matching time index</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/prms-python-200x.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=PRMS-Python&repo=docs&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial and Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html#example-parameter-sensitivity">Example: Parameter sensitivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-parameter-statsvar-helper-functions">Data, Parameter, Statsvar helper functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nash-sutcliffe">Nash-Sutcliffe</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="tutorial.html" title="previous chapter">Tutorial and Recipes</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, John Volk and Matthew Turner.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>